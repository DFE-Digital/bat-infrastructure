groups:
- name: High-CPU
  rules:
%{ for app in apps ~}
  - alert: High-CPU-${app}
    expr: avg by ( app ) (cpu{app=~"${app}"}) > 1
    for: 5m
    annotations:
      summary: ${app} High CPU Alert
      description: "CPU usage of at least 1% for more than 5 minutes (current value: {{ $value }})"
      dashboard: https://grafana-bat.london.cloudapps.digital/d/eF19g4RZx/cf-apps?orgId=1&refresh=10s
    labels:
      environment: production
      severity: high
      app: ${app}
%{ endfor ~}
